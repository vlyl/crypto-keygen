# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is the modernized BIP39 mnemonic code converter tool - a security-critical cryptographic application that generates Bitcoin addresses and keys from BIP39 mnemonic phrases. Originally created by Ian Coleman, this version has been completely rewritten using modern web technologies while maintaining the same core functionality and security principles.

**Technology Stack:**
- **Frontend**: React 18 with TypeScript
- **Build Tool**: Vite with SWC
- **Package Manager**: pnpm
- **Styling**: Tailwind CSS with custom components
- **State Management**: Zustand with persistence
- **Testing**: Vitest (unit) + Playwright (e2e)
- **Cryptography**: Latest bitcoinjs ecosystem + noble-crypto libraries

## Build and Development Commands

### Development
- `pnpm install` - Install all dependencies
- `pnpm run dev` - Start development server on localhost:8000
- `pnpm run build` - Build for production
- `pnpm run preview` - Preview production build locally

### Code Quality
- `pnpm run type-check` - Run TypeScript type checking
- `pnpm run lint` - Run ESLint
- `pnpm run lint:fix` - Auto-fix ESLint issues
- `pnpm run format` - Format code with Prettier

### Testing
- `pnpm run test` - Run unit tests with Vitest
- `pnpm run test:ui` - Run tests with UI
- `pnpm run test:coverage` - Generate coverage report
- `pnpm run e2e` - Run end-to-end tests with Playwright
- `pnpm run e2e:ui` - Run e2e tests with UI

### Legacy Support
- `python compile.py` - Legacy build command (deprecated, use `pnpm run build`)
- Old test commands are no longer needed - use modern testing above

## Architecture

### Modern File Structure
```
src/
├── components/           # React components
│   ├── ui/              # Reusable UI components
│   ├── MnemonicGenerator.tsx
│   ├── WalletInfo.tsx
│   ├── DerivationPath.tsx
│   ├── AddressList.tsx
│   └── Header.tsx
├── lib/                 # Core business logic
│   ├── bip39.ts        # BIP39 wallet implementation
│   ├── entropy.ts      # Entropy processing
│   ├── networks.ts     # Network configurations
│   └── qr.ts          # QR code generation
├── stores/             # State management
│   └── wallet.ts      # Zustand store
├── types/             # TypeScript type definitions
│   ├── crypto.ts      # Crypto-related types
│   └── index.ts       # Exported types
├── utils/             # Utility functions
│   ├── crypto.ts      # Cryptographic utilities
│   └── format.ts      # Formatting helpers
├── test/              # Test files
│   ├── e2e/          # Playwright tests
│   └── setup.ts      # Test configuration
├── App.tsx           # Main application component
├── main.tsx          # Application entry point
└── index.css         # Global styles
```

### Key Components

**Core Cryptographic Libraries:**
- `bip39@^3.1.0` - BIP39 mnemonic implementation
- `bip32@^4.0.0` - BIP32 hierarchical deterministic wallets
- `bitcoinjs-lib@^6.1.6` - Bitcoin cryptographic primitives
- `tiny-secp256k1@^2.2.3` - Optimized secp256k1 implementation
- `@noble/hashes@^1.4.0` - Modern cryptographic hashing
- `@noble/secp256k1@^2.0.0` - Pure JavaScript secp256k1

**Features:**
- **Modern UI**: React-based interface with Tailwind CSS
- **Type Safety**: Full TypeScript implementation
- **PWA Support**: Offline-capable Progressive Web App
- **Security**: Enhanced security warnings and practices
- **Testing**: Comprehensive unit and e2e test coverage
- **Performance**: Optimized build with code splitting
- **Accessibility**: WCAG compliant components

### Security Features
- Cryptographically secure random number generation
- Client-side only operation (no network requests)
- Memory-safe cryptographic operations
- Privacy screen for sensitive data
- Comprehensive security warnings
- QR code generation with security warnings
- Offline-first architecture

## Development Guidelines

### Making Changes
- **Never modify `bip39-standalone.html`** directly - it's generated by the build process
- Make all changes in TypeScript source files under `src/`
- Follow TypeScript strict mode requirements
- Use the established component patterns and utilities
- Maintain backwards compatibility with original functionality
- Run tests before committing changes

### Code Standards
- Use TypeScript for all new code
- Follow ESLint configuration
- Use Prettier for code formatting
- Write comprehensive tests for new features
- Document security-critical functions
- Use semantic commit messages

### Testing Requirements
- Unit tests for all utility functions and business logic
- Component tests for React components
- E2e tests for critical user flows
- Security-focused tests for cryptographic operations
- Cross-browser testing via Playwright

### Release Process
1. Update version in `package.json`
2. Run full test suite: `pnpm run test && pnpm run e2e`
3. Run type checking and linting: `pnpm run type-check && pnpm run lint`
4. Build production version: `pnpm run build`
5. Test production build: `pnpm run preview`
6. Commit changes with message `Release vX.Y.Z`
7. Create git tag: `git tag vX.Y.Z`
8. Push to trigger automated release pipeline

### CI/CD Pipeline
- **Automated Testing**: All PRs run full test suite
- **Security Scanning**: Dependencies scanned for vulnerabilities
- **Cross-platform Testing**: Tests run on multiple Node.js versions
- **Automated Releases**: Tagged commits trigger release builds
- **GitHub Pages**: Automatic deployment to GitHub Pages
- **Standalone Generation**: Automatic creation of standalone HTML file

## Important Security Notes

- This is a **security-critical** cryptocurrency tool handling sensitive data
- All cryptographic operations are performed client-side
- No data is transmitted over networks
- Uses industry-standard, audited cryptographic libraries
- Standalone version should work completely offline
- Always verify SHA256 checksums of releases
- Consider security implications of any modifications
- Test thoroughly on air-gapped systems for production use

## Migration from Legacy Version

The modernized version maintains full API compatibility with the original while providing:
- Better performance and user experience
- Enhanced security practices
- Modern development workflow
- Comprehensive testing
- Maintainable codebase
- Progressive Web App capabilities

The original `src/index.html` and JavaScript files are preserved in the `backup/` directory for reference.